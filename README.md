# Tinkoff Trading Bot

–¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Tinkoff Invest API. –ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Spring Boot —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tinkoff Invest API
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö
- –†–∞–±–æ—Ç–∞ —Å –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- REST API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–¢–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Java 21**
- **Spring Boot 3.2.0**
- **Spring Data JPA**
- **PostgreSQL**
- **WebFlux** (–¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤)
- **Lombok**

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –í–∞—Ä–∏–∞–Ω—Ç A: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL —Å –ø–æ–º–æ—â—å—é Docker Compose:

```bash
docker-compose up -d
```

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [DOCKER_SETUP.md](DOCKER_SETUP.md)

#### –í–∞—Ä–∏–∞–Ω—Ç B: –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL:

```sql
CREATE DATABASE tbot_db;
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/main/resources/application.yml`:

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/tbot_db
    username: your_username
    password: your_password

tinkoff:
  api:
    token: your_tinkoff_api_token
    use-sandbox: true  # true –¥–ª—è –ø–µ—Å–æ—á–Ω–∏—Ü—ã, false –¥–ª—è –±–æ–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ Tinkoff API

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [Tinkoff Invest](https://www.tinkoff.ru/invest/)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
3. –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Å–æ—á–Ω–∏—Ü—É (sandbox)

## –ó–∞–ø—É—Å–∫

```bash
mvn spring-boot:run
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8080

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8080

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
- üìä **Dashboard** - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- üìã **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- üíº **–ü–æ—Ä—Ç—Ñ–µ–ª—å** - –¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- üìà **–û—Ä–¥–µ—Ä–∞** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ –æ—Ä–¥–µ—Ä–∞–º–∏
- üéØ **–¢–æ—Ä–≥–æ–≤–ª—è** - –†–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- ‚öôÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [WEB_INTERFACE.md](WEB_INTERFACE.md)

## API Endpoints

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- `GET /api/tinkoff/instruments` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `GET /api/tinkoff/instruments/{figi}` - –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ –ø–æ FIGI

### –ü–æ—Ä—Ç—Ñ–µ–ª—å

- `GET /api/tinkoff/portfolio?accountId={accountId}` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å –ø–æ ID –∞–∫–∫–∞—É–Ω—Ç–∞
- `GET /api/tinkoff/accounts` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤

### –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- `GET /api/tinkoff/market-data/{figi}` - –ü–æ–ª—É—á–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ FIGI

### –¢–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

- `POST /api/tinkoff/orders/market-buy` - –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É
- `POST /api/tinkoff/orders/market-sell` - –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
- `POST /api/tinkoff/orders/limit` - –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä
- `POST /api/tinkoff/orders/cancel` - –û—Ç–º–µ–Ω–∏—Ç—å –æ—Ä–¥–µ—Ä
- `GET /api/tinkoff/orders/{orderId}` - –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ—Ä–¥–µ—Ä–∞
- `GET /api/tinkoff/orders` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/main/java/ru/perminov/
‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ TinkoffApiConfig.java
‚îú‚îÄ‚îÄ controller/       # REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ TinkoffController.java
‚îú‚îÄ‚îÄ model/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ Instrument.java
‚îÇ   ‚îú‚îÄ‚îÄ Order.java
‚îÇ   ‚îî‚îÄ‚îÄ Position.java
‚îú‚îÄ‚îÄ repository/      # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ JPA
‚îÇ   ‚îú‚îÄ‚îÄ InstrumentRepository.java
‚îÇ   ‚îú‚îÄ‚îÄ OrderRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ PositionRepository.java
‚îú‚îÄ‚îÄ service/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ TinkoffApiService.java
‚îÇ   ‚îî‚îÄ‚îÄ TradingService.java
‚îî‚îÄ‚îÄ Main.java        # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## Tinkoff Invest API

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Tinkoff Invest API](https://russianinvestments.github.io/investAPI/swagger-ui/) –¥–ª—è:

- –ü–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö
- –†–∞–±–æ—Ç—ã —Å –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –†–∞–∑–º–µ—â–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ API:

1. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
2. **–ü–æ—Ä—Ç—Ñ–µ–ª—å** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∑–∏—Ü–∏—è—Ö –∏ –∞–∫—Ç–∏–≤–∞—Ö
3. **–†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Å–≤–µ—á–∏
4. **–¢–æ—Ä–≥–æ–≤–ª—è** - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ –æ—Ç–º–µ–Ω–∞ –æ—Ä–¥–µ—Ä–æ–≤
5. **–ü–µ—Å–æ—á–Ω–∏—Ü–∞** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥–µ

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–æ–¥ –≤ `TinkoffApiService`
2. –î–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ `TinkoffController`
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JPA –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL. –ú–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –¢–æ–∫–µ–Ω API —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License 