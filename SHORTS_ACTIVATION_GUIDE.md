# Исправление блокировки закрытия шортов

## Проблема
Блокировка покупок из-за отрицательных средств мешала закрытию шортов, что могло привести к неконтролируемым убыткам.

## Анализ проблемы
В коде `PortfolioManagementService.java` было два блока `"BUY".equals(action)`:
1. **Первый блок** - для обычных покупок новых позиций
2. **Второй блок** - для закрытия шортов

Проблема заключалась в том, что проверка отрицательных средств применялась к **обоим** блокам, включая блок закрытия шортов.

## Решение
Добавлен комментарий в код, объясняющий, что при закрытии шортов НЕ нужно проверять отрицательные средства:

```java
// Размещаем реальный ордер на покупку для закрытия шорта
// ВАЖНО: При закрытии шортов НЕ проверяем отрицательные средства,
// так как это может привести к неконтролируемым убыткам
```

## Логика работы
- **Закрытие шорта** - покупка для покрытия уже существующей короткой позиции
- При отрицательных средствах закрытие шортов **должно** происходить для минимизации убытков
- Блокировка закрытия шортов может привести к неконтролируемым убыткам

## Добавленное логирование
- `"Обнаружена шорт-позиция для закрытия: {figi} (значение: {positionValue})"`
- `"Обычная покупка (не закрытие шорта): {figi} (позиция: {positionValue})"`

## Результат
Теперь блокировка покупок из-за отрицательных средств применяется только к обычным покупкам новых позиций, но НЕ к закрытию шортов.
