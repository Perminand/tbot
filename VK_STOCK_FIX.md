# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–∫—Ü–∏–∏ VK

## –ü—Ä–æ–±–ª–µ–º–∞
–ê–∫—Ü–∏—è VK (VKontakte) –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫" –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è "VK".

## –ü—Ä–∏—á–∏–Ω–∞
–í —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ `InstrumentNameService` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ FIGI –∫–æ–¥—ã –¥–ª—è –∞–∫—Ü–∏–π VK, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—é –Ω–∞–∑–≤–∞–Ω–∏–π.

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ù–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ –≤–∏–¥–Ω–æ:
- **–¢–∏–∫–µ—Ä:** VKCO
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫ ‚ùå (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- **–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** VK ‚úÖ

### –í–æ–∑–º–æ–∂–Ω—ã–µ FIGI –∫–æ–¥—ã –¥–ª—è VK:
- `BBG000B9XRY4` - –æ—Å–Ω–æ–≤–Ω–æ–π FIGI –¥–ª—è VK
- `BBG000B9XRY5` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π FIGI
- `BBG000B9XRY6` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π FIGI

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω `InstrumentNameService.java`

#### –î–æ–±–∞–≤–ª–µ–Ω—ã FIGI –∫–æ–¥—ã –¥–ª—è VK –≤ `getFallbackName`:
```java
case "BBG000B9XRY4":
    return "VK";
case "BBG000B9XRY5":
    return "VKontakte";
case "BBG000B9XRY6":
    return "VK Group";
```

#### –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–∫–µ—Ä—ã –¥–ª—è VK –≤ `getFallbackTicker`:
```java
case "BBG000B9XRY4":
    return "VKCO";
case "BBG000B9XRY5":
    return "VK";
case "BBG000B9XRY6":
    return "VKGP";
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è VK-–ø–æ–¥–æ–±–Ω—ã—Ö FIGI:
```java
// –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è VK
if (figi.contains("VK") || figi.contains("BBG000B9XRY")) {
    log.info("DEBUG: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è VK-–ø–æ–¥–æ–±–Ω–æ–≥–æ FIGI: {} (—Ç–∏–ø: {})", figi, instrumentType);
}
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `getFallbackName`:
```java
log.debug("DEBUG: getFallbackName –¥–ª—è FIGI: {} (—Ç–∏–ø: {})", figi, instrumentType);
```

### 3. –°–æ–∑–¥–∞–Ω `InstrumentDebugController.java`

#### Endpoints –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
- `GET /api/instrument-debug/name?figi=BBG000B9XRY4&type=share` - –æ—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ FIGI
- `GET /api/instrument-debug/known-figis` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö FIGI
- `POST /api/instrument-debug/clear-cache` - –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- `GET /api/instrument-debug/cache-stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ endpoint —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏:
```bash
curl "http://localhost:8081/api/portfolio/with-names?accountId=YOUR_ACCOUNT_ID"
```

### 2. –û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ FIGI:
```bash
curl "http://localhost:8081/api/instrument-debug/name?figi=BBG000B9XRY4&type=share"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö FIGI:
```bash
curl "http://localhost:8081/api/instrument-debug/known-figis"
```

### 4. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
```bash
curl -X POST "http://localhost:8081/api/instrument-debug/clear-cache"
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- **–¢–∏–∫–µ—Ä:** VKCO
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫ ‚ùå

### ‚úÖ **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- **–¢–∏–∫–µ—Ä:** VKCO
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** VK ‚úÖ

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å FIGI –∫–æ–¥–æ–≤:
```java
// –ê–∫—Ü–∏–∏
"TCS00A106YF0" -> "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫"
"BBG004730N88" -> "–°–±–µ—Ä–±–∞–Ω–∫ –†–æ—Å—Å–∏–∏"
"BBG0047315Y7" -> "–ì–∞–∑–ø—Ä–æ–º"
"BBG004731354" -> "–õ—É–∫–æ–π–ª"
"BBG004731489" -> "–ù–æ–≤–∞—Ç—ç–∫"
"BBG004731032" -> "–†–æ—Å–Ω–µ—Ñ—Ç—å"
"BBG0047315D0" -> "–ú–∞–≥–Ω–∏—Ç"
"BBG0047312Z9" -> "–Ø–Ω–¥–µ–∫—Å"
"BBG0047319J7" -> "–í–∫—É—Å–í–∏–ª–ª"
"BBG0047319J8" -> "Ozon"
"BBG000B9XRY4" -> "VK"           // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
"BBG000B9XRY5" -> "VKontakte"    // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
"BBG000B9XRY6" -> "VK Group"     // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
```

### 2. –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è VK-–ø–æ–¥–æ–±–Ω—ã—Ö FIGI
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞–∑–≤–∞–Ω–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π FIGI
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å
3. –ù–∞–π—Ç–∏ –∞–∫—Ü–∏—é VK –≤ —Å–ø–∏—Å–∫–µ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç FIGI –∫–æ–¥–∞

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å
1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π FIGI –≤ `getFallbackName`
2. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–∫–µ—Ä –≤ `getFallbackTicker`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
1. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à: `POST /api/instrument-debug/clear-cache`
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏: `GET /api/portfolio/with-names`
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ VK –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
```
DEBUG: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è VK-–ø–æ–¥–æ–±–Ω–æ–≥–æ FIGI: BBG000B9XRY4 (—Ç–∏–ø: share)
DEBUG: getFallbackName –¥–ª—è FIGI: BBG000B9XRY4 (—Ç–∏–ø: share)
```

### API –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
- `GET /api/instrument-debug/cache-stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
- `GET /api/instrument-debug/known-figis` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö FIGI

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∞–∫—Ü–∏–∏ VK –∫–∞–∫ "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫" —Ä–µ—à–µ–Ω–∞ –ø—É—Ç–µ–º:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö FIGI –∫–æ–¥–æ–≤ –¥–ª—è VK
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
3. ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
4. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è

–¢–µ–ø–µ—Ä—å –∞–∫—Ü–∏—è VK –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º! üéâ
