# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

**–ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫:**
- ‚ùå –•–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ FIGI –≤ –∫–æ–¥–µ
- ‚ùå –ë–æ—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏
- ‚ùå –ü–æ–ø—ã—Ç–∫–∏ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–ª 6+ –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **DynamicInstrumentService**

–ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏:

#### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **TTL –∫—ç—à–∞:** 5 –º–∏–Ω—É—Ç
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ TTL
- **–†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫:** –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
```java
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π
if (!dynamicInstrumentService.isInstrumentAvailable(figi)) {
    log.warn("–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç {} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º", figi);
    return; // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
}
```

#### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫
```java
// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
List<ShareDto> instruments = dynamicInstrumentService.getAvailableInstruments();

// –°–ª—É—á–∞–π–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
Optional<ShareDto> random = dynamicInstrumentService.getRandomAvailableInstrument();

// –ü–æ —Ç–∏–ø—É
List<ShareDto> shares = dynamicInstrumentService.getInstrumentsByType("share");
```

### 2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
- ‚úÖ **–ù–ï –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞** –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- ‚úÖ **–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É** —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **Graceful degradation** –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```java
try {
    executeTradingStrategy(accountId, figi);
} catch (Exception e) {
    log.error("–û—à–∏–±–∫–∞ –¥–ª—è {}: {}", figi, e.getMessage());
    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, –ù–ï –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞
}
```

### 3. **–†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏:
- `TCS00A106YF0` - –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫ (–∞–∫—Ü–∏—è)
- `BBG004730N88` - –°–±–µ—Ä–±–∞–Ω–∫ –†–æ—Å—Å–∏–∏ (–∞–∫—Ü–∏—è)
- `TCS00A107D74` - –û–±–ª–∏–≥–∞—Ü–∏—è –¢–∏–Ω—å–∫–æ—Ñ—Ñ (–æ–±–ª–∏–≥–∞—Ü–∏—è)

## üîß API Endpoints

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞
POST /api/dynamic-instruments/update-cache

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
POST /api/dynamic-instruments/clear-cache

# –°—Ç–∞—Ç—É—Å –∫—ç—à–∞
GET /api/dynamic-instruments/cache-status
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
```bash
# –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
GET /api/dynamic-instruments/available

# –ü–æ —Ç–∏–ø—É
GET /api/dynamic-instruments/by-type?type=share

# –°–ª—É—á–∞–π–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
GET /api/dynamic-instruments/random
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- `DynamicInstrumentService` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞
- `PortfolioManagementService` - –∞–Ω–∞–ª–∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `TradingBotScheduler` - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

### –ö–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –û—à–∏–±–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ (–±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞)
- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå –ë–æ—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
- ‚ùå –•–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ FIGI
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- ‚ùå –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:
- **–ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É** - –ë—ã—Å—Ç—Ä—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç** - –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–ö–∞–∂–¥—ã–π —á–∞—Å** - –ü–æ—á–∞—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** –∏–∑ –∫—ç—à–∞
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
3. **–ê–Ω–∞–ª–∏–∑ —Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**
4. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
5. **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π:
- [ ] –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏
- [ ] –°—Ç–∞—Ç—É—Å —Ç–æ—Ä–≥–æ–≤–ª–∏: `NORMAL_TRADING`
- [ ] –î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–∫—É–ø–∫–∞: `buyAvailableFlag = true`
- [ ] –î–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–æ–¥–∞–∂–∞: `sellAvailableFlag = true`
- [ ] API —Ç–æ—Ä–≥–æ–≤–ª—è –¥–æ—Å—Ç—É–ø–Ω–∞: `apiTradeAvailableFlag = true`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- [ ] Graceful degradation

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (5 –º–∏–Ω—É—Ç TTL)
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **–ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏** (100-200ms)
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### –õ–∏–º–∏—Ç—ã:
- **–ú–∞–∫—Å–∏–º—É–º –∞–∫—Ü–∏–π:** 30
- **–ú–∞–∫—Å–∏–º—É–º –æ–±–ª–∏–≥–∞—Ü–∏–π:** 15
- **–ú–∞–∫—Å–∏–º—É–º ETF:** 10
- **–ê–Ω–∞–ª–∏–∑ –∑–∞ —Ä–∞–∑:** 10 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –±–æ—Ç:
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ** –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ** –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç** —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ **–ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É** –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- ‚úÖ **–ö—ç—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **–ò–º–µ–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø–ª–∞–Ω** –ø—Ä–∏ —Å–±–æ—è—Ö API



