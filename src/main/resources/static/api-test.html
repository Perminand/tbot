<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç API - –¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .api-result {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { border-color: #28a745; background-color: #d4edda; }
        .error { border-color: #dc3545; background-color: #f8d7da; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1>üß™ –¢–µ—Å—Ç API Endpoints</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>–¢–µ—Å—Ç API –∞–∫–∫–∞—É–Ω—Ç–æ–≤</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="testAccountsAPI()">
                            –¢–µ—Å—Ç /api/trading-bot/accounts
                        </button>
                        <div id="accountsResult" class="api-result mt-3"></div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>–¢–µ—Å—Ç API —Å–µ–∫—Ç–æ—Ä–æ–≤</h5>
                    </div>
                    <div class="card-body">
                                            <button class="btn btn-success" onclick="testSectorsAPI()">
                        –¢–µ—Å—Ç /api/sectors/list
                    </button>
                    <button class="btn btn-info mt-2" onclick="testSectorTestAPI()">
                        –¢–µ—Å—Ç /api/sectors/test
                    </button>
                    <div id="sectorsResult" class="api-result mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>–¢–µ—Å—Ç API —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-info" onclick="testBotStatusAPI()">
                            –¢–µ—Å—Ç /api/trading-bot/status
                        </button>
                        <div id="botStatusResult" class="api-result mt-3"></div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>–¢–µ—Å—Ç –≤—Å–µ—Ö API</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-warning" onclick="testAllAPIs()">
                            –¢–µ—Å—Ç –≤—Å–µ—Ö endpoints
                        </button>
                        <div id="allResults" class="api-result mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showResult(elementId, data, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.textContent = JSON.stringify(data, null, 2);
            element.className = `api-result ${isSuccess ? 'success' : 'error'}`;
        }

        async function testAccountsAPI() {
            try {
                const response = await fetch('/api/trading-bot/accounts');
                const data = await response.json();
                
                if (response.ok) {
                    showResult('accountsResult', data, true);
                } else {
                    showResult('accountsResult', { error: data, status: response.status }, false);
                }
            } catch (error) {
                showResult('accountsResult', { error: error.message }, false);
            }
        }

        async function testSectorsAPI() {
            try {
                const response = await fetch('/api/sectors/list');
                const data = await response.json();
                
                if (response.ok) {
                    showResult('sectorsResult', data, true);
                } else {
                    showResult('sectorsResult', { error: data, status: response.status }, false);
                }
            } catch (error) {
                showResult('sectorsResult', { error: error.message }, false);
            }
        }
        
        async function testSectorTestAPI() {
            try {
                const response = await fetch('/api/sectors/test');
                const data = await response.json();
                
                if (response.ok) {
                    showResult('sectorsResult', data, true);
                } else {
                    showResult('sectorsResult', { error: data, status: response.status }, false);
                }
            } catch (error) {
                showResult('sectorsResult', { error: error.message }, false);
            }
        }

        async function testBotStatusAPI() {
            try {
                const response = await fetch('/api/trading-bot/status');
                const data = await response.json();
                
                if (response.ok) {
                    showResult('botStatusResult', data, true);
                } else {
                    showResult('botStatusResult', { error: data, status: response.status }, false);
                }
            } catch (error) {
                showResult('botStatusResult', { error: error.message }, false);
            }
        }

        async function testAllAPIs() {
            const results = {};
            
            // –¢–µ—Å—Ç API –∞–∫–∫–∞—É–Ω—Ç–æ–≤
            try {
                const response = await fetch('/api/trading-bot/accounts');
                const data = await response.json();
                results.accounts = { success: response.ok, data, status: response.status };
            } catch (error) {
                results.accounts = { success: false, error: error.message };
            }
            
            // –¢–µ—Å—Ç API —Å–µ–∫—Ç–æ—Ä–æ–≤
            try {
                const response = await fetch('/api/sectors/list');
                const data = await response.json();
                results.sectors = { success: response.ok, data, status: response.status };
            } catch (error) {
                results.sectors = { success: false, error: error.message };
            }
            
            // –¢–µ—Å—Ç API —Å–µ–∫—Ç–æ—Ä–æ–≤ (—Ç–µ—Å—Ç–æ–≤—ã–π endpoint)
            try {
                const response = await fetch('/api/sectors/test');
                const data = await response.json();
                results.sectorsTest = { success: response.ok, data, status: response.status };
            } catch (error) {
                results.sectorsTest = { success: false, error: error.message };
            }
            
            // –¢–µ—Å—Ç API —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞
            try {
                const response = await fetch('/api/trading-bot/status');
                const data = await response.json();
                results.botStatus = { success: response.ok, data, status: response.status };
            } catch (error) {
                results.botStatus = { success: false, error: error.message };
            }
            
            showResult('allResults', results, true);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API...');
            setTimeout(testAllAPIs, 1000);
        });
    </script>
</body>
</html>
